<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Busca de Peças</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        input[type="text"], select { padding: 8px; width: 80%; }
        button { padding: 8px 12px; cursor: pointer; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    </style>
</head>
<body>

<h1>Busca de Peças</h1>
<form id="searchForm">
    <input type="text" id="pieceName" placeholder="Digite o nome da peça (ex: Barra de direção)" required><br><br>
    <input type="text" id="vehicleBrand" placeholder="Marca do veículo (ex: Toyota)" required><br><br>
    <input type="text" id="vehicleModel" placeholder="Modelo do veículo (ex: Corolla)" required><br><br>
    <button type="button" onclick="searchProduct()">Buscar</button>
</form>

<table id="resultsTable" style="display:none;">
    <thead>
        <tr>
            <th>Referência</th>
            <th>Nome</th>
            <th>Descrição</th>
            <th>Marca</th>
            <th>Categoria</th>
            <th>Marca Veículo</th>
            <th>Modelo Veículo</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
function searchProduct() {
    let pieceName = document.getElementById('pieceName').value;
    let vehicleBrand = document.getElementById('vehicleBrand').value;
    let vehicleModel = document.getElementById('vehicleModel').value;

    fetch(`search.php?q=${encodeURIComponent(pieceName)}&vehicle_brand=${encodeURIComponent(vehicleBrand)}&vehicle_model=${encodeURIComponent(vehicleModel)}`)
    .then(response => response.json())
    .then(data => {
        let resultsTable = document.getElementById('resultsTable');
        let tbody = resultsTable.querySelector('tbody');
        tbody.innerHTML = '';  // Clear previous results

        if (data.error) {
            alert(data.error);
            return;
        }

        resultsTable.style.display = 'table';
        data.forEach(item => {
            let row = tbody.insertRow();
            row.insertCell(0).textContent = item.reference;
            row.insertCell(1).textContent = item.name;
            row.insertCell(2).textContent = item.description;
            row.insertCell(3).textContent = item.brand;
            row.insertCell(4).textContent = item.category;
            row.insertCell(5).textContent = item.vehicle_brand;
            row.insertCell(6).textContent = item.vehicle_model;
        });
    });
}
</script>

</body>
</html>
